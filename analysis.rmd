---
title: "Analysis of Wine Data"
author: "Andrew Prozorovsky"
date: "`r sys.Date()`"
output: "html_document"
---

```{r}
# install.packages("hms")
# install.packages("rmarkdown")
# install.packages("readr")
# install.packages("ggplot2")
```

```{r message=FALSE, warning=FALSE}
# load packages
library(readr)
library(dplyr)
library(ggplot2)
```

```{r message=FALSE, warning=FALSE}
# load visits and checkouts data
wine_reviews <- read_csv('Resources/winemag-data-130k-v2.csv')
```

```{r}
# inspect dataframe and fix column name
head(wine_reviews)
print(nrow(wine_reviews))
print(length(wine_reviews))
wine_reviews = wine_reviews %>%
    rename("id" = "...1")
col_names = colnames(wine_reviews)
print(col_names)
```

```{r}
wine_counts = wine_reviews %>%
  group_by(country) %>%
  summarise(wine_count = n()) %>%
  arrange(desc(wine_count))

top_10_countries = head(wine_counts, 10)
```

```{r}
# bar chart that groups and counts the data by country of origin
countries_bar = ggplot(wine_counts, aes(x = reorder(country, -wine_count), y = wine_count)) + 
  geom_bar(stat = "identity") +
  geom_text(aes(label = wine_count), vjust = -0.5, size = 3) +
  ggtitle("Number of Wines by Country") +
  xlab("Country") +
  ylab("Number of Wines") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))

countries_bar
```

```{r}
# group, order, and filter the data so only the top 15 countries are shown on the chart
top_10_countries_bar = ggplot(top_10_countries, aes(x = reorder(country, -wine_count), y = wine_count)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = wine_count), vjust = -0.5, size = 3) +
  ggtitle("Top 10 Countries by Number of Wines") +
  xlab("Country") +
  ylab("Number of Wines") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

top_10_countries_bar
```

```{r}
# scatterplot of price of wines against points
price_points_plot = ggplot(wine_reviews, aes(x = points, y = price)) +
  geom_point(alpha=0.4, aes(color="darkviolet")) +
  labs(title = "Scatterplot of Points vs. Price",
       x = "Points",
       y = "Price") +
  geom_smooth()
price_points_plot
```

```{r}
# graph of top wineries
winery_counts = wine_reviews %>%
  group_by(winery) %>%
  summarise(winery_count = n()) %>%
  arrange(desc(winery_count))

top_10_wineries = head(winery_counts, 10)

top_10_wineries_bar = ggplot(top_10_wineries, aes(x = reorder(winery, -winery_count), y = winery_count)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = winery_count), vjust = -0.5, size = 3) +
  ggtitle("Top 10 Wineries by Number of Wines") +
  xlab("Winery") +
  ylab("Number of Wines") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

top_10_wineries_bar
```

```{r}
# graph of top varieties
variety_counts = wine_reviews %>%
  group_by(variety) %>%
  summarise(variety_count = n()) %>%
  arrange(desc(variety_count))

top_10_varieties = head(variety_counts, 10)

top_10_varieties_bar = ggplot(top_10_varieties, aes(x = reorder(variety, -variety_count), y = variety_count)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = variety_count), vjust = -0.5, size = 3) +
  ggtitle("Top 10 Wine Varieties from the Data") +
  xlab("Variety") +
  ylab("Number of Wines") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

top_10_varieties_bar
```


```{r}
# graph of top provinces
province_counts = wine_reviews %>%
  group_by(province) %>%
  summarise(province_count = n()) %>%
  arrange(desc(province_count))

top_10_provinces = head(province_counts, 10)

top_10_provinces_bar = ggplot(top_10_provinces, aes(x = reorder(province, -province_count), y = province_count)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = province_count), vjust = -0.5, size = 3) +
  ggtitle("Top 10 Provinces by Number of Wines") +
  xlab("Province") +
  ylab("Number of Wines") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

top_10_provinces_bar
```

```{r}
# scatterplot of wineries by average points

```

```{r}
# scatterplot of wineries by average price

```

```{r}
# scatterplot of varieties by average points

```

```{r}
# scatterplot of varieties by average price

```

