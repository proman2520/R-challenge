---
title: "Analysis of Wine Data"
author: "Andrew Prozorovsky"
date: "`r sys.Date()`"
output: "html_document"
---

```{r}
# install.packages("hms")
# install.packages("rmarkdown")
# install.packages("readr")
# install.packages("ggplot2")
```

```{r message=FALSE, warning=FALSE}
# load packages
library(readr)
library(dplyr)
library(ggplot2)
```

```{r message=FALSE, warning=FALSE}
# load visits and checkouts data
wine_reviews <- read_csv('Resources/winemag-data-130k-v2.csv')
```

```{r}
# inspect dataframe and fix column name
head(wine_reviews)
print(nrow(wine_reviews))
print(length(wine_reviews))
wine_reviews = wine_reviews %>%
    rename("id" = "...1")
col_names = colnames(wine_reviews)
print(col_names)
```

```{r}
wine_counts <- wine_reviews %>%
  group_by(country) %>%
  summarise(wine_count = n()) %>%
  arrange(desc(wine_count))

top_10_countries <- head(wine_counts, 10)
```

```{r}
# bar chart that groups and counts the data by country of origin
countries_bar = ggplot(wine_counts, aes(x = reorder(country, -wine_count), y = wine_count)) + 
  geom_bar(stat = "identity") +
  geom_text(aes(label = wine_count), vjust = -0.5, size = 3) +
  ggtitle("Number of Wines by Country") +
  xlab("Country") +
  ylab("Number of Wines") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))

countries_bar
```

```{r}
# group, order, and filter the data so only the top 15 countries are shown on the chart
top_10_countries_bar = ggplot(top_10_countries, aes(x = reorder(country, -wine_count), y = wine_count)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = wine_count), vjust = -0.5, size = 3) +
  ggtitle("Top 10 Countries by Number of Wines") +
  xlab("Country") +
  ylab("Number of Wines") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

top_10_countries_bar
```

```{r}
# scatterplot of price of wines against points

```

```{r}
# graph of top wineries

```

```{r}
# graph of top varieties

```


```{r}
# graph of top provinces

```